<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>EL PAÍS: El periódico global</title>
    
    <!-- DNS Prefetch para recursos externos -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    <link rel="dns-prefetch" href="https://scripts.converteai.net">
    <link rel="dns-prefetch" href="https://escala.purelifenews.com">
    
    <!-- Preconnect para fontes (carregamento mais rápido) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Fontes otimizadas com display=swap para evitar FOIT -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Merriweather:wght@400;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Merriweather:wght@400;700&display=swap" rel="stylesheet"></noscript>
    
    <!-- Google Tag Manager (async para não bloquear) -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s);j.async=true;j.src="https://escala.purelifenews.com/cechksinwxgg.js?"+i;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','6sinyrou=DgNFMDokXj8hKTpDLVAnTRFaSllfTxcFWhcNBQsFGg0CCR0AHUcQBAo%3D');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Vturb CTA Tracking - Captura cliques no botão do player -->
    <script>
      console.log('[VTurb Tracking] Script initialized');
      window.dataLayer = window.dataLayer || [];
      
      (function() {
        var ctaTracked = false;
        var listenerAttached = false;
        console.log('[VTurb Tracking] Setting up MutationObserver and listeners...');
        
        function pushInitiateCheckout(source) {
          if (ctaTracked) return;
          ctaTracked = true;
          
          window.dataLayer.push({
            'event': 'initiate_checkout',
            'event_category': 'ecommerce',
            'event_label': 'vturb_cta_click',
            'cta_source': source || 'vturb_smartplayer'
          });
          console.log('[VTurb Tracking] InitiateCheckout pushed to dataLayer from:', source);
        }
        
        function attachSmartPlayerListeners() {
          if (listenerAttached) return;
          
          var smartplayer = window.smartplayer;
          if (!smartplayer || !smartplayer.instances || smartplayer.instances.length === 0) {
            return false;
          }
          
          var player = smartplayer.instances[0];
          console.log('[VTurb Tracking] SmartPlayer instance found, attaching CTA listeners...');
          
          if (player && typeof player.on === 'function') {
            listenerAttached = true;
            
            var ctaEvents = ['cta_click', 'ctaclick', 'ctaClick', 'cta-click', 'smartplayer_cta'];
            ctaEvents.forEach(function(eventName) {
              try {
                player.on(eventName, function(eventData) {
                  console.log('[VTurb Tracking] CTA click detected via "' + eventName + '":', eventData);
                  pushInitiateCheckout('smartplayer_' + eventName);
                });
              } catch (e) {}
            });
            
            console.log('[VTurb Tracking] CTA listeners attached successfully');
            return true;
          }
          return false;
        }
        
        function pollForSmartPlayer() {
          var attempts = 0;
          var maxAttempts = 120;
          
          var poll = function() {
            if (attachSmartPlayerListeners()) {
              return;
            }
            attempts++;
            if (attempts < maxAttempts) {
              setTimeout(poll, 500);
            } else {
              console.log('[VTurb Tracking] Max attempts reached, smartplayer not found');
            }
          };
          
          poll();
        }
        
        function startTracking() {
          console.log('[VTurb Tracking] VTurb iframe detected, starting smartplayer polling...');
          pollForSmartPlayer();
        }
        
        var observer = new MutationObserver(function(mutations) {
          mutations.forEach(function(mutation) {
            mutation.addedNodes.forEach(function(node) {
              if (node.nodeType === 1) {
                if (node.tagName === 'IFRAME' && node.src && node.src.includes('converteai.net')) {
                  startTracking();
                }
                var iframes = node.querySelectorAll ? node.querySelectorAll('iframe[src*="converteai.net"]') : [];
                if (iframes.length > 0) {
                  startTracking();
                }
              }
            });
          });
        });
        
        observer.observe(document.documentElement, { childList: true, subtree: true });
        
        var existingIframe = document.querySelector('iframe[src*="converteai.net"]');
        if (existingIframe) {
          startTracking();
        }
        
        window.addEventListener('message', function(event) {
          try {
            var data = event.data;
            
            if (typeof data === 'string') {
              try {
                data = JSON.parse(data);
              } catch (e) {
                if (data.toLowerCase().includes('cta')) {
                  console.log('[VTurb Tracking] CTA string message detected:', data);
                  pushInitiateCheckout('postmessage_string');
                }
                return;
              }
            }
            
            if (!data || typeof data !== 'object') return;
            
            var isCTAEvent = 
              data.event === 'cta_click' || 
              data.event === 'cta-click' ||
              data.event === 'ctaclick' ||
              data.event === 'ctaClicked' ||
              data.type === 'cta_click' ||
              data.type === 'smartplayer_cta' ||
              (data.detail && data.detail.event && data.detail.event.includes('cta')) ||
              (data.name && data.name.toLowerCase().includes('cta')) ||
              (data.action && data.action.toLowerCase().includes('cta'));
            
            if (isCTAEvent) {
              console.log('[VTurb Tracking] CTA event detected via postMessage:', data);
              pushInitiateCheckout('postmessage');
            }
          } catch (e) {
            console.log('[VTurb Tracking] Error processing message:', e);
          }
        });
      })();
    </script>
    <!-- End Vturb CTA Tracking -->
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              serif: ['Merriweather', 'serif'],
              sans: ['Inter', 'sans-serif'],
            },
            colors: {
              news: {
                black: '#121212',
                yellow: '#F7D844',
                blue: '#005596',
                gray: '#4a4a4a',
                lightgray: '#f5f5f5'
              }
            }
          }
        }
      }
    </script>
    <style>
      /* Hide scrollbar for clean horizontal scrolling if needed */
      .no-scrollbar::-webkit-scrollbar {
        display: none;
      }
      .no-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
      
      /* Pulsing animation for CTA buttons */
      @keyframes pulse-glow {
        0%, 100% {
          transform: scale(1);
          box-shadow: 0 0 0 0 rgba(247, 216, 68, 0.7);
        }
        50% {
          transform: scale(1.02);
          box-shadow: 0 0 20px 5px rgba(247, 216, 68, 0.4);
        }
      }
      .animate-pulse-cta {
        animation: pulse-glow 2s ease-in-out infinite;
      }
    </style>
  </head>
  <body class="bg-white text-news-black font-sans antialiased">
    <div id="root"></div>
    <script type="module" src="/index.tsx"></script>
  </body>
</html>